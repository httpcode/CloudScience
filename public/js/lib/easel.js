/**
* EaselJS
* Visit http://easeljs.com/ for documentation, updates and examples.
*
* Copyright (c) 2011 Grant Skinner
* 
* Permission is hereby granted, free of charge, to any person
* obtaining a copy of this software and associated documentation
* files (the "Software"), to deal in the Software without
* restriction, including without limitation the rights to use,
* copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the
* Software is furnished to do so, subject to the following
* conditions:
* 
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
* 
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
* HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
* WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
* OTHER DEALINGS IN THE SOFTWARE.
**/
(function(a){UID=function(){throw"UID cannot be instantiated"};UID._nextID=0;UID.get=function(){return UID._nextID++};a.UID=UID})(window);(function(a){Matrix2D=function(a,b,c,d,e,f){this.initialize(a,b,c,d,e,f)};var b=Matrix2D.prototype;Matrix2D.identity=null;Matrix2D.DEG_TO_RAD=Math.PI/180;b.a=1;b.b=0;b.c=0;b.d=1;b.tx=0;b.ty=0;b.alpha=1;b.shadow=null;b.compositeOperation=null;b.initialize=function(a,b,c,d,e,f){if(a!=null){this.a=a}if(b!=null){this.b=b}if(c!=null){this.c=c}if(d!=null){this.d=d}if(e!=null){this.tx=e}if(f!=null){this.ty=f}};b.prepend=function(a,b,c,d,e,f){var g=this.tx;if(a!=1||b!=0||c!=0||d!=1){var h=this.a;var i=this.c;this.a=h*a+this.b*c;this.b=h*b+this.b*d;this.c=i*a+this.d*c;this.d=i*b+this.d*d}this.tx=g*a+this.ty*c+e;this.ty=g*b+this.ty*d+f};b.append=function(a,b,c,d,e,f){var g=this.a;var h=this.b;var i=this.c;var j=this.d;this.a=a*g+b*i;this.b=a*h+b*j;this.c=c*g+d*i;this.d=c*h+d*j;this.tx=e*g+f*i+this.tx;this.ty=e*h+f*j+this.ty};b.prependMatrix=function(a){this.prepend(a.a,a.b,a.c,a.d,a.tx,a.ty);this.prependProperties(a.alpha,a.shadow,a.compositeOperation)};b.appendMatrix=function(a){this.append(a.a,a.b,a.c,a.d,a.tx,a.ty);this.appendProperties(a.alpha,a.shadow,a.compositeOperation)};b.prependTransform=function(a,b,c,d,e,f,g,h,i){if(e%360){var j=e*Matrix2D.DEG_TO_RAD;var k=Math.cos(j);var l=Math.sin(j)}else{k=1;l=0}if(h||i){this.tx-=h;this.ty-=i}if(f||g){f*=Matrix2D.DEG_TO_RAD;g*=Matrix2D.DEG_TO_RAD;this.prepend(k*c,l*c,-l*d,k*d,0,0);this.prepend(Math.cos(g),Math.sin(g),-Math.sin(f),Math.cos(f),a,b)}else{this.prepend(k*c,l*c,-l*d,k*d,a,b)}};b.appendTransform=function(a,b,c,d,e,f,g,h,i){if(e%360){var j=e*Matrix2D.DEG_TO_RAD;var k=Math.cos(j);var l=Math.sin(j)}else{k=1;l=0}if(f||g){f*=Matrix2D.DEG_TO_RAD;g*=Matrix2D.DEG_TO_RAD;this.append(Math.cos(g),Math.sin(g),-Math.sin(f),Math.cos(f),a,b);this.append(k*c,l*c,-l*d,k*d,0,0)}else{this.append(k*c,l*c,-l*d,k*d,a,b)}if(h||i){this.tx-=h*this.a+i*this.c;this.ty-=h*this.b+i*this.d}};b.rotate=function(a){var b=Math.cos(a);var c=Math.sin(a);var d=this.a;var e=this.c;var f=this.tx;this.a=d*b-this.b*c;this.b=d*c+this.b*b;this.c=e*b-this.d*c;this.d=e*c+this.d*b;this.tx=f*b-this.ty*c;this.ty=f*c+this.ty*b};b.skew=function(a,b){a=a*Matrix2D.DEG_TO_RAD;b=b*Matrix2D.DEG_TO_RAD;this.append(Math.cos(b),Math.sin(b),-Math.sin(a),Math.cos(a),0,0)};b.scale=function(a,b){this.a*=a;this.d*=b;this.tx*=a;this.ty*=b};b.translate=function(a,b){this.tx+=a;this.ty+=b};b.identity=function(){this.alpha=this.a=this.d=1;this.b=this.c=this.tx=this.ty=0;this.shadow=this.compositeOperation=null};b.invert=function(){var a=this.a;var b=this.b;var c=this.c;var d=this.d;var e=this.tx;var f=a*d-b*c;this.a=d/f;this.b=-b/f;this.c=-c/f;this.d=a/f;this.tx=(c*this.ty-d*e)/f;this.ty=-(a*this.ty-b*e)/f};b.decompose=function(a){if(a==null){a={}}a.x=this.tx;a.y=this.ty;a.scaleX=Math.sqrt(this.a*this.a+this.b*this.b);a.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);var b=Math.atan2(-this.c,this.d);var c=Math.atan2(this.b,this.a);if(b==c){a.rotation=c/Matrix2D.DEG_TO_RAD;if(this.a<0&&this.d>=0){a.rotation+=a.rotation<=0?180:-180}a.skewX=a.skewY=0}else{a.skewX=b/Matrix2D.DEG_TO_RAD;a.skewY=c/Matrix2D.DEG_TO_RAD}return a};b.appendProperties=function(a,b,c){this.alpha*=a;this.shadow=b||this.shadow;this.compositeOperation=c||this.compositeOperation};b.prependProperties=function(a,b,c){this.alpha*=a;this.shadow=this.shadow||b;this.compositeOperation=this.compositeOperation||c};b.clone=function(){var a=new Matrix2D(this.a,this.b,this.c,this.d,this.tx,this.ty);a.shadow=this.shadow;a.alpha=this.alpha;a.compositeOperation=this.compositeOperation;return a};b.toString=function(){return"[Matrix2D (a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+")]"};Matrix2D.identity=new Matrix2D(1,0,0,1,0,0);a.Matrix2D=Matrix2D})(window);(function(a){MouseEvent=function(a,b,c){this.initialize(a,b,c)};var b=MouseEvent.prototype;b.stageX=0;b.stageY=0;b.type=null;b.onMouseMove=null;b.onMouseUp=null;b.initialize=function(a,b,c){this.type=a;this.stageX=b;this.stageY=c};b.clone=function(){return new MouseEvent(this.type,this.stageX,this.stageY)};b.toString=function(){return"[MouseEvent (type="+this.type+" stageX="+this.stageX+" stageY="+this.stageY+")]"};a.MouseEvent=MouseEvent})(window);(function(a){SpriteSheetUtils=function(){throw"SpriteSheetUtils cannot be instantiated"};SpriteSheetUtils._workingCanvas=document.createElement("canvas");SpriteSheetUtils._workingContext=SpriteSheetUtils._workingCanvas.getContext("2d");SpriteSheetUtils.flip=function(a,b){var c=a.image;var d=a.frameData;var e=a.frameWidth;var f=a.frameHeight;var g=c.width/e|0;var h=c.height/f|0;var i=g*h;var j={};var k;for(var l in d){k=d[l];if(k instanceof Array){k=k.slice(0)}j[l]=k}var m=[];var n=0;var o=0;for(l in b){var p=b[l];k=d[p[0]];if(k==null){continue}if(k instanceof Array){var q=k[0];var r=k[1];if(r==null){r=q}}else{q=r=k}m[o]=l;m[o+1]=q;m[o+2]=r;n+=r-q+1;o+=4}this._workingCanvas=document.createElement("canvas");this._workingContext=this._workingCanvas.getContext("2d");var s=SpriteSheetUtils._workingCanvas;s.width=c.width;s.height=Math.ceil(h+n/g)*f;var t=SpriteSheetUtils._workingContext;t.drawImage(c,0,0,g*e,h*f,0,0,g*e,h*f);var u=i-1;for(o=0;o<m.length;o+=4){l=m[o];q=m[o+1];r=m[o+2];p=b[l];var v=p[1]?-1:1;var w=p[2]?-1:1;var x=v==-1?e:0;var y=w==-1?f:0;for(var z=q;z<=r;z++){u++;t.save();t.translate(u%g*e+x,(u/g|0)*f+y);t.scale(v,w);t.drawImage(c,z%g*e,(z/g|0)*f,e,f,0,0,e,f);t.restore()}j[l]=[u-(r-q),u,p[3]]}var A=new Image;A.src=s.toDataURL("image/png");return new SpriteSheet(A.width>0?A:s,e,f,j)};SpriteSheetUtils.frameDataToString=function(a){var b="";var c=0;var d=0;var e=0;var f,g;for(var h in a){e++;f=a[h];if(f instanceof Array){var i=f[0];var j=f[1];if(j==null){j=i}g=f[2];if(g==null){g=h}}else{i=j=f;g=h}b+="\n\t"+h+", start="+i+", end="+j+", next="+g;if(g==false){b+=" (stop)"}else if(g==h){b+=" (loop)"}if(j>c){c=j}if(i<d){d=i}}b=e+" sequences, min="+d+", max="+c+b;return b};SpriteSheetUtils.extractFrame=function(a,b){var c=a.image;var d=a.frameWidth;var e=a.frameHeight;var f=c.width/d|0;if(isNaN(b)){var g=a.frameData[b];if(g instanceof Array){b=g[0]}else{b=g}}var h=SpriteSheetUtils._workingCanvas;h.width=d;h.height=e;SpriteSheetUtils._workingContext.drawImage(c,b%f*d,(b/f|0)*e,d,e,0,0,d,e);var i=new Image;i.src=h.toDataURL("image/png");return i};a.SpriteSheetUtils=SpriteSheetUtils})(window);(function(a){SpriteSheet=function(a,b,c,d){this.initialize(a,b,c,d)};var b=SpriteSheet.prototype;b.image=null;b.frameWidth=0;b.frameHeight=0;b.frameData=null;b.loop=true;b.totalFrames=0;b.initialize=function(a,b,c,d){this.image=a;this.frameWidth=b;this.frameHeight=c;this.frameData=d};b.toString=function(){return"[SpriteSheet]"};b.clone=function(){var a=new SpriteSheet(this.image,this.frameWidth,this.frameHeight,this.frameData);a.loop=this.loop;a.totalFrames=this.totalFrames;return a};a.SpriteSheet=SpriteSheet})(window);(function(a){DisplayObject=function(){this.initialize()};var b=DisplayObject.prototype;DisplayObject.suppressCrossDomainErrors=false;DisplayObject._hitTestCanvas=document.createElement("canvas");DisplayObject._hitTestCanvas.width=DisplayObject._hitTestCanvas.height=1;DisplayObject._hitTestContext=DisplayObject._hitTestCanvas.getContext("2d");DisplayObject._workingMatrix=new Matrix2D;b.alpha=1;b.cacheCanvas=null;b.id=-1;b.mouseEnabled=true;b.name=null;b.parent=null;b.regX=0;b.regY=0;b.rotation=0;b.scaleX=1;b.scaleY=1;b.skewX=0;b.skewY=0;b.shadow=null;b.visible=true;b.x=0;b.y=0;b.compositeOperation=null;b.snapToPixel=false;b.onPress=null;b.onClick=null;b.onMouseOver=null;b.onMouseOut=null;b._cacheOffsetX=0;b._cacheOffsetY=0;b._cacheDraw=false;b._activeContext=null;b._restoreContext=false;b._revertShadow=false;b._revertX=0;b._revertY=0;b._revertAlpha=1;b.initialize=function(){this.id=UID.get();this.children=[]};b.isVisible=function(){return this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0};b.draw=function(a,b){if(b||!this.cacheCanvas){return false}a.translate(this._cacheOffsetX,this._cacheOffsetY);a.drawImage(this.cacheCanvas,0,0);a.translate(-this._cacheOffsetX,-this._cacheOffsetY);return true};b.cache=function(a,b,c,d){var e;if(this.cacheCanvas==null){this.cacheCanvas=document.createElement("canvas")}e=this.cacheCanvas.getContext("2d");this.cacheCanvas.width=c;this.cacheCanvas.height=d;e.setTransform(1,0,0,1,-a,-b);e.clearRect(0,0,c+1,d+1);this.draw(e,true);this._cacheOffsetX=a;this._cacheOffsetY=b};b.updateCache=function(a){if(this.cacheCanvas==null){throw"cache() must be called before updateCache()"}var b=this.cacheCanvas.getContext("2d");b.setTransform(1,0,0,1,-this._cacheOffsetX,-this._cacheOffsetY);if(!a){b.clearRect(0,0,this.cacheCanvas.width+1,this.cacheCanvas.height+1)}else{b.globalCompositeOperation=a}this.draw(b,true);if(a){b.globalCompositeOperation="source-over"}};b.uncache=function(){this.cacheCanvas=null;this.cacheOffsetX=this.cacheOffsetY=0};b.getStage=function(){var a=this;while(a.parent){a=a.parent}if(a instanceof Stage){return a}return null};b.localToGlobal=function(a,b){var c=this.getConcatenatedMatrix();if(c==null){return null}c.append(1,0,0,1,a,b);return new Point(c.tx,c.ty)};b.globalToLocal=function(a,b){var c=this.getConcatenatedMatrix();if(c==null){return null}c.invert();c.append(1,0,0,1,a,b);return new Point(c.tx,c.ty)};b.localToLocal=function(a,b,c){var d=this.localToGlobal(a,b);return c.globalToLocal(d.x,d.y)};b.getConcatenatedMatrix=function(a){if(a){a.identity()}else{a=new Matrix2D}var b=this;while(b!=null){a.prependTransform(b.x,b.y,b.scaleX,b.scaleY,b.rotation,b.skewX,b.skewY,b.regX,b.regY);a.prependProperties(b.alpha,b.shadow,b.compositeOperation);b=b.parent}return a};b.hitTest=function(a,b){var c=DisplayObject._hitTestContext;var d=DisplayObject._hitTestCanvas;c.setTransform(1,0,0,1,-a,-b);this.draw(c);var e=this._testHit(c);d.width=0;d.width=1;return e};b.clone=function(){var a=new DisplayObject;this.cloneProps(a);return a};b.toString=function(){return"[DisplayObject (name="+this.name+")]"};b.cloneProps=function(a){a.alpha=this.alpha;a.name=this.name;a.regX=this.regX;a.regY=this.regY;a.rotation=this.rotation;a.scaleX=this.scaleX;a.scaleY=this.scaleY;a.shadow=this.shadow;a.skewX=this.skewX;a.skewY=this.skewY;a.visible=this.visible;a.x=this.x;a.y=this.y;a.mouseEnabled=this.mouseEnabled;a.compositeOperation=this.compositeOperation};b.applyShadow=function(a,b){b=b||Shadow.identity;a.shadowColor=b.color;a.shadowOffsetX=b.offsetX;a.shadowOffsetY=b.offsetY;a.shadowBlur=b.blur};b._testHit=function(a){try{var b=a.getImageData(0,0,1,1).data[3]>1}catch(c){if(!DisplayObject.suppressCrossDomainErrors){throw"An error has occured. This is most likely due to security restrictions on reading canvas pixel "+"data with local or cross-domain images."}}return b};a.DisplayObject=DisplayObject})(window);(function(a){Container=function(){this.initialize()};var b=Container.prototype=new DisplayObject;b.children=null;b.DisplayObject_initialize=b.initialize;b.initialize=function(){this.DisplayObject_initialize();this.children=[]};b.isVisible=function(){return this.visible&&this.alpha>0&&this.children.length&&this.scaleX!=0&&this.scaleY!=0};b.DisplayObject_draw=b.draw;b.draw=function(a,b,c){var d=Stage._snapToPixelEnabled;if(!c){c=new Matrix2D;c.appendProperties(this.alpha,this.shadow,this.compositeOperation)}if(this.DisplayObject_draw(a,b)){return true}var e=this.children.length;var f=this.children.slice(0);for(var g=0;g<e;g++){var h=f[g];if(h.tick){h.tick()}if(!h.isVisible()){continue}var i=false;var j=c.clone();j.appendTransform(h.x,h.y,h.scaleX,h.scaleY,h.rotation,h.skewX,h.skewY,h.regX,h.regY);j.appendProperties(h.alpha,h.shadow,h.compositeOperation);if(!(h instanceof Container)){if(d&&h.snapToPixel&&j.a==1&&j.b==0&&j.c==0&&j.d==1){a.setTransform(j.a,j.b,j.c,j.d,j.tx+.5|0,j.ty+.5|0)}else{a.setTransform(j.a,j.b,j.c,j.d,j.tx,j.ty)}a.globalAlpha=j.alpha;a.globalCompositeOperation=j.compositeOperation||"source-over";if(i=j.shadow){this.applyShadow(a,i)}}h.draw(a,false,j);if(i){this.applyShadow(a)}}return true};b.addChild=function(a){var b=arguments.length;if(b>1){for(var c=0;c<b;c++){this.addChild(arguments[c])}return arguments[b-1]}if(a.parent){a.parent.removeChild(a)}a.parent=this;this.children.push(a);return a};b.addChildAt=function(a,b){var c=arguments.length;if(c>2){b=arguments[d-1];for(var d=0;d<c-1;d++){this.addChildAt(arguments[d],b+d)}return arguments[c-2]}if(a.parent){a.parent.removeChild(a)}a.parent=this;this.children.splice(b,0,a);return a};b.removeChild=function(a){var b=arguments.length;if(b>1){var c=true;for(var d=0;d<b;d++){c=c&&this.removeChild(arguments[d])}return c}return this.removeChildAt(this.children.indexOf(a))};b.removeChildAt=function(a){var b=arguments.length;if(b>1){var c=[];for(var d=0;d<b;d++){c[d]=arguments[d]}c.sort(function(a,b){return b-a});var e=true;for(var d=0;d<b;d++){e=e&&this.removeChildAt(c[d])}return e}if(a<0||a>this.children.length-1){return false}var f=this.children[a];if(f!=null){f.parent=null}this.children.splice(a,1);return true};b.removeAllChildren=function(){while(this.children.length){this.removeChildAt(0)}};b.getChildAt=function(a){return this.children[a]};b.sortChildren=function(a){this.children.sort(a)};b.getChildIndex=function(a){return this.children.indexOf(a)};b.getNumChildren=function(){return this.children.length};b.contains=function(a){while(a){if(a==this){return true}a=a.parent}return false};b.hitTest=function(a,b){return this.getObjectUnderPoint(a,b)!=null};b.getObjectsUnderPoint=function(a,b){var c=[];var d=this.localToGlobal(a,b);this._getObjectsUnderPoint(d.x,d.y,c);return c};b.getObjectUnderPoint=function(a,b){var c=this.localToGlobal(a,b);return this._getObjectsUnderPoint(c.x,c.y)};b.clone=function(a){var b=new Container;this.cloneProps(b);if(a){var c=b.children=[];for(var d=0,e=this.children.length;d<e;d++){c.push(this.children[d].clone(a))}}return b};b.toString=function(){return"[Container (name="+this.name+")]"};b._getObjectsUnderPoint=function(a,b,c,d){var e=DisplayObject._hitTestContext;var f=DisplayObject._hitTestCanvas;var g=DisplayObject._workingMatrix;var h=d&1&&(this.onPress||this.onClick)||d&2&&(this.onMouseOver||this.onMouseOut);if(this.cacheCanvas){this.getConcatenatedMatrix(g);e.setTransform(g.a,g.b,g.c,g.d,g.tx-a,g.ty-b);e.globalAlpha=g.alpha;this.draw(e);if(this._testHit(e)){f.width=0;f.width=1;if(h){return this}}else{return null}}var i=this.children.length;for(var j=i-1;j>=0;j--){var k=this.children[j];if(!k.isVisible()||!k.mouseEnabled){continue}if(k instanceof Container){var l;if(h){l=k._getObjectsUnderPoint(a,b);if(l){return this}}else{l=k._getObjectsUnderPoint(a,b,c,d);if(!c&&l){return l}}}else if(!d||h||d&1&&(k.onPress||k.onClick)||d&2&&(k.onMouseOver||k.onMouseOut)){k.getConcatenatedMatrix(g);e.setTransform(g.a,g.b,g.c,g.d,g.tx-a,g.ty-b);e.globalAlpha=g.alpha;k.draw(e);if(!this._testHit(e)){continue}f.width=0;f.width=1;if(h){return this}else if(c){c.push(k)}else{return k}}}return null};a.Container=Container})(window);(function(a){Stage=function(a){this.initialize(a)};var b=Stage.prototype=new Container;Stage._snapToPixelEnabled=false;b.autoClear=true;b.canvas=null;b.mouseX=null;b.mouseY=null;b.onMouseMove=null;b.onMouseUp=null;b.onMouseDown=null;b.snapToPixelEnabled=false;b.mouseInBounds=false;b._tmpCanvas=null;b._activeMouseEvent=null;b._activeMouseTarget=null;b._mouseOverIntervalID=null;b._mouseOverX=0;b._mouseOverY=0;b._mouseOverTarget=null;b.Container_initialize=b.initialize;b.initialize=function(b){this.Container_initialize();this.canvas=b;this.mouseChildren=true;var c=this;if(a.addEventListener){a.addEventListener("mouseup",function(a){c._handleMouseUp(a)},false);a.addEventListener("mousemove",function(a){c._handleMouseMove(a)},false)}else if(document.addEventListener){document.addEventListener("mouseup",function(a){c._handleMouseUp(a)},false);document.addEventListener("mousemove",function(a){c._handleMouseMove(a)},false)}b.addEventListener("mousedown",function(a){c._handleMouseDown(a)},false)};b.update=function(){if(!this.canvas){return}if(this.autoClear){this.clear()}Stage._snapToPixelEnabled=this.snapToPixelEnabled;this.draw(this.canvas.getContext("2d"),false,this.getConcatenatedMatrix(DisplayObject._workingMatrix))};b.tick=b.update;b.clear=function(){if(!this.canvas){return}var a=this.canvas.getContext("2d");a.setTransform(1,0,0,1,0,0);a.clearRect(0,0,this.canvas.width,this.canvas.height)};b.toDataURL=function(a,b){if(!b){b="image/png"}var c=this.canvas.getContext("2d");var d=this.canvas.width;var e=this.canvas.height;var f;if(a){f=c.getImageData(0,0,d,e);var g=c.globalCompositeOperation;c.globalCompositeOperation="destination-over";c.fillStyle=a;c.fillRect(0,0,d,e)}var h=this.canvas.toDataURL(b);if(a){c.clearRect(0,0,d,e);c.putImageData(f,0,0);c.globalCompositeOperation=g}return h};b.enableMouseOver=function(a){if(this._mouseOverIntervalID){clearInterval(this._mouseOverIntervalID);this._mouseOverIntervalID=null}if(a<=0){return}var b=this;this._mouseOverIntervalID=setInterval(function(){b._testMouseOver()},1e3/Math.min(50,a));this._mouseOverX=NaN;this._mouseOverTarget=null};b.clone=function(){var a=new Stage(null);this.cloneProps(a);return a};b.toString=function(){return"[Stage (name="+this.name+")]"};b._handleMouseMove=function(b){if(!this.canvas){this.mouseX=this.mouseY=null;return}if(!b){b=a.event}var c=this.mouseInBounds;this._updateMousePosition(b.pageX,b.pageY);if(!c&&!this.mouseInBounds){return}var d=new MouseEvent("onMouseMove",this.mouseX,this.mouseY);if(this.onMouseMove){this.onMouseMove(d)}if(this._activeMouseEvent&&this._activeMouseEvent.onMouseMove){this._activeMouseEvent.onMouseMove(d)}};b._updateMousePosition=function(a,b){var c=this.canvas;do{a-=c.offsetLeft;b-=c.offsetTop}while(c=c.offsetParent);this.mouseInBounds=a>=0&&b>=0&&a<this.canvas.width&&b<this.canvas.height;if(this.mouseInBounds){this.mouseX=a;this.mouseY=b}};b._handleMouseUp=function(a){var b=new MouseEvent("onMouseUp",this.mouseX,this.mouseY);if(this.onMouseUp){this.onMouseUp(b)}if(this._activeMouseEvent&&this._activeMouseEvent.onMouseUp){this._activeMouseEvent.onMouseUp(b)}if(this._activeMouseTarget&&this._activeMouseTarget.onClick&&this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,true,this._mouseOverIntervalID?3:1)==this._activeMouseTarget){this._activeMouseTarget.onClick(new MouseEvent("onClick",this.mouseX,this.mouseY))}this._activeMouseEvent=this.activeMouseTarget=null};b._handleMouseDown=function(a){if(this.onMouseDown){this.onMouseDown(new MouseEvent("onMouseDown",this.mouseX,this.mouseY))}var b=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,this._mouseOverIntervalID?3:1);if(b){if(b.onPress instanceof Function){var c=new MouseEvent("onPress",this.mouseX,this.mouseY);b.onPress(c);if(c.onMouseMove||c.onMouseUp){this._activeMouseEvent=c}}this._activeMouseTarget=b}};b._testMouseOver=function(){if(this.mouseX==this._mouseOverX&&this.mouseY==this._mouseOverY&&this.mouseInBounds){return}var a=null;if(this.mouseInBounds){var a=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,3);this._mouseOverX=this.mouseX;this._mouseOverY=this.mouseY}if(this._mouseOverTarget!=a){if(this._mouseOverTarget&&this._mouseOverTarget.onMouseOut){this._mouseOverTarget.onMouseOut(new MouseEvent("onMouseOver",this.mouseX,this.mouseY))}if(a&&a.onMouseOver){a.onMouseOver(new MouseEvent("onMouseOut",this.mouseX,this.mouseY))}this._mouseOverTarget=a}};a.Stage=Stage})(window);(function(a){Bitmap=function(a){this.initialize(a)};var b=Bitmap.prototype=new DisplayObject;b.image=null;b.snapToPixel=true;b.DisplayObject_initialize=b.initialize;b.initialize=function(a){this.DisplayObject_initialize();this.image=a};b.isVisible=function(){return this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0&&this.image&&(this.image.complete||this.image.getContext)};b.DisplayObject_draw=b.draw;b.draw=function(a,b){if(this.DisplayObject_draw(a,b)){return true}a.drawImage(this.image,0,0);return true};b.clone=function(){var a=new Bitmap(this.image);this.cloneProps(a);return a};b.toString=function(){return"[Bitmap (name="+this.name+")]"};a.Bitmap=Bitmap})(window);(function(a){BitmapSequence=function(a){this.initialize(a)};var b=BitmapSequence.prototype=new DisplayObject;b.callback=null;b.currentFrame=-1;b.currentSequence=null;b.currentEndFrame=null;b.currentStartFrame=null;b.nextSequence=null;b.paused=false;b.spriteSheet=null;b.snapToPixel=true;b.DisplayObject_initialize=b.initialize;b.initialize=function(a){this.DisplayObject_initialize();this.spriteSheet=a};b.isVisible=function(){var a=this.spriteSheet?this.spriteSheet.image:null;return this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0&&a&&this.currentFrame>=0&&(a.complete||a.getContext)};b.DisplayObject_draw=b.draw;b.draw=function(a,b){if(this.DisplayObject_draw(a,b)){return true}var c=this.spriteSheet.image;var d=this.spriteSheet.frameWidth;var e=this.spriteSheet.frameHeight;var f=c.width/d|0;var g=c.height/e|0;if(this.currentEndFrame!=null){if(this.currentFrame>this.currentEndFrame){if(this.nextSequence){this._goto(this.nextSequence)}else{this.paused=true;this.currentFrame=this.currentEndFrame}if(this.callback){this.callback(this)}}}else{var h=this.spriteSheet.totalFrames||f*g;if(this.currentFrame>=h){if(this.spriteSheet.loop){this.currentFrame=0}else{this.currentFrame=h-1;this.paused=true}if(this.callback){this.callback(this)}}}if(this.currentFrame>=0){var i=this.currentFrame%f;var j=this.currentFrame/f|0;a.drawImage(c,d*i,e*j,d,e,0,0,d,e)}return true};b.tick=function(){if(this.currentFrame==-1&&this.spriteSheet.frameData){this.paused=true}if(this.paused){return}this.currentFrame++};b.gotoAndPlay=function(a){this.paused=false;this._goto(a)};b.gotoAndStop=function(a){this.paused=true;this._goto(a)};b.clone=function(){var a=new BitmapSequence(this.spriteSheet);this.cloneProps(a);return a};b.toString=function(){return"[BitmapSequence (name="+this.name+")]"};b.DisplayObject_cloneProps=b.cloneProps;b.cloneProps=function(a){this.DisplayObject_cloneProps(a);a.callback=this.callback;a.currentFrame=this.currentFrame;a.currentStartFrame=this.currentStartFrame;a.currentEndFrame=this.currentEndFrame;a.currentSequence=this.currentSequence;a.nextSequence=this.nextSequence;a.paused=this.paused;a.frameData=this.frameData};b._goto=function(a){if(isNaN(a)){if(a==this.currentSequence){this.currentFrame=this.currentStartFrame;return}var b=this.spriteSheet.frameData[a];if(b instanceof Array){this.currentFrame=this.currentStartFrame=b[0];this.currentSequence=a;this.currentEndFrame=b[1];if(this.currentEndFrame==null){this.currentEndFrame=this.currentStartFrame}if(this.currentEndFrame==null){this.currentEndFrame=this.currentFrame}this.nextSequence=b[2];if(this.nextSequence==null){this.nextSequence=this.currentSequence}else if(this.nextSequence==false){this.nextSequence=null}}else{this.currentSequence=this.nextSequence=null;this.currentEndFrame=this.currentFrame=this.currentStartFrame=b}}else{this.currentSequence=this.nextSequence=this.currentEndFrame=null;this.currentStartFrame=0;this.currentFrame=a}};a.BitmapSequence=BitmapSequence})(window);(function(a){Text=function(a,b,c){this.initialize(a,b,c)};var b=Text.prototype=new DisplayObject;Text._workingContext=document.createElement("canvas").getContext("2d");b.text="";b.font=null;b.color=null;b.textAlign=null;b.textBaseline=null;b.maxWidth=null;b.outline=false;b.lineHeight=null;b.lineWidth=null;b.DisplayObject_initialize=b.initialize;b.initialize=function(a,b,c){this.DisplayObject_initialize();this.text=a;this.font=b;this.color=c?c:"#000"};b.isVisible=function(){return Boolean(this.visible&&this.alpha>0&&this.scaleX!=0&&this.scaleY!=0&&this.text!=null&&this.text!="")};b.DisplayObject_draw=b.draw;b.draw=function(a,b){if(this.DisplayObject_draw(a,b)){return true}if(this.outline){a.strokeStyle=this.color}else{a.fillStyle=this.color}a.font=this.font;a.textAlign=this.textAlign?this.textAlign:"start";a.textBaseline=this.textBaseline?this.textBaseline:"alphabetic";var c=String(this.text).split(/(?:\r\n|\r|\n)/);var d=this.lineHeight==null?this.getMeasuredLineHeight():this.lineHeight;var e=0;for(var f=0,g=c.length;f<g;f++){var h=a.measureText(c[f]).width;if(this.lineWidth==null||h<this.lineWidth){this._drawTextLine(a,c[f],e);e+=d;continue}var i=c[f].split(/(\s)/);var j=i[0];for(var k=1,l=i.length;k<l;k+=2){if(a.measureText(j+i[k]+i[k+1]).width>this.lineWidth){this._drawTextLine(a,j,e);e+=d;j=i[k+1]}else{j+=i[k]+i[k+1]}}this._drawTextLine(a,j,e);e+=d}return true};b.getMeasuredWidth=function(){return this._getWorkingContext().measureText(this.text).width};b.getMeasuredLineHeight=function(){return this._getWorkingContext().measureText("M").width*1.2};b.clone=function(){var a=new Text(this.text,this.font,this.color);this.cloneProps(a);return a};b.toString=function(){return"[Text (text="+(this.text.length>20?this.text.substr(0,17)+"...":this.text)+")]"};b.DisplayObject_cloneProps=b.cloneProps;b.cloneProps=function(a){this.DisplayObject_cloneProps(a);a.textAlign=this.textAlign;a.textBaseline=this.textBaseline;a.maxWidth=this.maxWidth;a.outline=this.outline;a.lineHeight=this.lineHeight;a.lineWidth=this.lineWidth};b._getWorkingContext=function(){var a=Text._workingContext;a.font=this.font;a.textAlign=this.textAlign?this.textAlign:"start";a.textBaseline=this.textBaseline?this.textBaseline:"alphabetic";return a};b._drawTextLine=function(a,b,c){if(this.outline){a.strokeText(b,0,c,this.maxWidth)}else{a.fillText(b,0,c,this.maxWidth)}};a.Text=Text})(window);(function(a){Ticker=function(){throw"Ticker cannot be instantiated."};Ticker._listeners=[];Ticker._pauseable=[];Ticker._paused=false;Ticker._inited=false;Ticker._startTime=0;Ticker._pausedTime=0;Ticker._ticks=0;Ticker._pausedTickers=0;Ticker._interval=50;Ticker._intervalID=null;Ticker._lastTime=0;Ticker._times=[];Ticker.addListener=function(a,b){if(!Ticker._inited){Ticker._inited=true;Ticker.setInterval(Ticker._interval)}this.removeListener(a);Ticker._pauseable[Ticker._listeners.length]=b==null?true:b;Ticker._listeners.push(a)};Ticker.removeListener=function(a){if(Ticker._listeners==null){return}var b=Ticker._listeners.indexOf(a);if(b!=-1){Ticker._listeners.splice(b,1);Ticker._pauseable.splice(b,1)}};Ticker.removeAllListeners=function(){Ticker._listeners=[];Ticker._pauseable=[]};Ticker.setInterval=function(a){if(Ticker._intervalID!=null){clearInterval(Ticker._intervalID)}Ticker._lastTime=Ticker._getTime();Ticker._interval=a;Ticker._intervalID=setInterval(Ticker._tick,a)};Ticker.getInterval=function(){return Ticker._interval};Ticker.getFPS=function(){return 1e3/Ticker._interval};Ticker.setFPS=function(a){Ticker.setInterval(1e3/a)};Ticker.getMeasuredFPS=function(a){if(Ticker._times.length<2){return-1}if(a==null){a=Ticker.getFPS()>>1}a=Math.min(Ticker._times.length-1,a);return 1e3/((Ticker._times[0]-Ticker._times[a])/a)};Ticker.setPaused=function(a){Ticker._paused=a};Ticker.getPaused=function(){return Ticker._paused};Ticker.getTime=function(a){return Ticker._getTime()-Ticker._startTime-(a?Ticker._pausedTime:0)};Ticker.getTicks=function(a){return Ticker._ticks-(a?Ticker._pausedTickers:0)};Ticker._tick=function(){Ticker._ticks++;var a=Ticker.getTime(false);var b=a-Ticker._lastTime;var c=Ticker._paused;if(c){Ticker._pausedTickers++;Ticker._pausedTime+=b}Ticker._lastTime=a;var d=Ticker._pauseable;var e=Ticker._listeners;var f=e?e.length:0;for(var g=0;g<f;g++){var h=d[g];var i=e[g];if(i==null||c&&h||i.tick==null){continue}i.tick(b)}Ticker._times.unshift(a);if(Ticker._times.length>100){Ticker._times.pop()}};Ticker._getTime=function(){return(new Date).getTime()};Ticker._startTime=Ticker._getTime();a.Ticker=Ticker})(window);(function(a){Rectangle=function(a,b,c,d){this.initialize(a,b,c,d)};var b=Rectangle.prototype;b.x=0;b.y=0;b.width=0;b.height=0;b.initialize=function(a,b,c,d){this.x=a==null?0:a;this.y=b==null?0:b;this.width=c==null?0:c;this.height=d==null?0:d};b.clone=function(){return new Rectangle(this.x,this.y,this.width,this.height)};b.toString=function(){return"[Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")]"};a.Rectangle=Rectangle})(window);(function(a){Point=function(a,b){this.initialize(a,b)};var b=Point.prototype;b.x=0;b.y=0;b.initialize=function(a,b){this.x=a==null?0:a;this.y=b==null?0:b};b.clone=function(){return new Point(this.x,this.y)};b.toString=function(){return"[Point (x="+this.x+" y="+this.y+")]"};a.Point=Point})(window);(function(a){var b=function(){this.initialize()};var c=b.prototype;c.initialize=function(){};c.getBounds=function(){return new Rectangle(0,0,0,0)};c.applyFilter=function(a,b,c,d,e,f,g,h){};c.toString=function(){return"[Filter]"};c.clone=function(){return new b};a.Filter=b})(window);(function(a){var b=function(a,b,c,d,e,f,g,h){this.initialize(a,b,c,d,e,f,g,h)};var c=b.prototype=new Filter;c.redMultiplier=1;c.greenMultiplier=1;c.blueMultiplier=1;c.alphaMultiplier=1;c.redOffset=0;c.greenOffset=0;c.blueOffset=0;c.alphaOffset=0;c.initialize=function(a,b,c,d,e,f,g,h){this.redMultiplier=a!=null?a:1;this.greenMultiplier=b!=null?b:1;this.blueMultiplier=c!=null?c:1;this.alphaMultiplier=d!=null?d:1;this.redOffset=e||0;this.greenOffset=f||0;this.blueOffset=g||0;this.alphaOffset=h||0};c.applyFilter=function(a,b,c,d,e,f,g,h){f=f||a;if(g==null){g=b}if(h==null){h=c}try{var i=a.getImageData(b,c,d,e)}catch(j){return false}var k=i.data;var l=k.length;for(var m=0;m<l;m+=4){k[m]=k[m]*this.redMultiplier+this.redOffset;k[m+1]=k[m+1]*this.greenMultiplier+this.greenOffset;k[m+2]=k[m+2]*this.blueMultiplier+this.blueOffset;k[m+3]=k[m+3]*this.alphaMultiplier+this.alphaOffset}i.data=k;f.putImageData(i,g,h);return true};c.toString=function(){return"[ColorFilter]"};c.clone=function(){return new b(this.redMultiplier,this.greenMultiplier,this.blueMultiplier,this.alphaMultiplier,this.redOffset,this.greenOffset,this.blueOffset,this.alphaOffset)};a.ColorFilter=b})(window);(function(a){var b=function(a,b,c){this.initialize(a,b,c)};var c=b.prototype=new Filter;c.initialize=function(a,b,c){if(isNaN(a)||a<0)a=0;this.blurX=a|0;if(isNaN(b)||b<0)b=0;this.blurY=b|0;if(isNaN(c)||c<1)c=1;this.quality=c|0};c.blurX=0;c.blurY=0;c.quality=1;c.getBounds=function(){return new Rectangle(-this.blurX,-this.blurY,2*this.blurX,2*this.blurY)};c.applyFilter=function(a,b,c,d,e,f,g,h){f=f||a;if(g==null){g=b}if(h==null){h=c}try{var i=a.getImageData(b,c,d,e)}catch(j){return false}var k=this.blurX;if(isNaN(k)||k<0)return false;k|=0;var l=this.blurY;if(isNaN(l)||l<0)return false;l|=0;if(k==0&&l==0)return false;var m=this.quality;if(isNaN(m)||m<1)m=1;m|=0;if(m>3)m=3;if(m<1)m=1;var n=i.data;var o,p,q,r,b,c,s,t,u,v,w,x,y;var z=d-1;var A=e-1;var B=k+1;var C=k+B;var D=l+1;var E=l+D;var F=1/(C*E);var G=[];var H=[];var I=[];var J=[];var K=[];var L=[];while(m-->0){y=x=0;for(c=0;c<e;c++){o=n[y]*B;p=n[y+1]*B;q=n[y+2]*B;r=n[y+3]*B;for(s=1;s<=k;s++){t=y+((s>z?z:s)<<2);o+=n[t++];p+=n[t++];q+=n[t++];r+=n[t]}for(b=0;b<d;b++){G[x]=o;H[x]=p;I[x]=q;J[x]=r;if(c==0){K[b]=Math.min(b+B,z)<<2;L[b]=Math.max(b-k,0)<<2}u=y+K[b];v=y+L[b];o+=n[u++]-n[v++];p+=n[u++]-n[v++];q+=n[u++]-n[v++];r+=n[u]-n[v];x++}y+=d<<2}for(b=0;b<d;b++){w=b;o=G[w]*D;p=H[w]*D;q=I[w]*D;r=J[w]*D;for(s=1;s<=l;s++){w+=s>A?0:d;o+=G[w];p+=H[w];q+=I[w];r+=J[w]}x=b<<2;for(c=0;c<e;c++){n[x]=o*F+.5|0;n[x+1]=p*F+.5|0;n[x+2]=q*F+.5|0;n[x+3]=r*F+.5|0;if(b==0){K[c]=Math.min(c+D,A)*d;L[c]=Math.max(c-l,0)*d}u=b+K[c];v=b+L[c];o+=G[u]-G[v];p+=H[u]-H[v];q+=I[u]-I[v];r+=J[u]-J[v];x+=d<<2}}}f.putImageData(i,g,h);return true};c.clone=function(){return new b(this.blurX,this.blurY,this.quality)};c.toString=function(){return"[BoxBlurFilter (name="+this.name+")]"};a.BoxBlurFilter=b})(window);(function(a){var b=function(a){this.initialize(a)};var c=b.prototype=new Filter;c.matrix=null;c.initialize=function(a){this.matrix=a};c.applyFilter=function(a,b,c,d,e,f,g,h){f=f||a;if(g==null){g=b}if(h==null){h=c}try{var i=a.getImageData(b,c,d,e)}catch(j){return false}var k=i.data;var l=k.length;var m,n,o,p;var q=this.matrix;var r=q[0],s=q[1],t=q[2],u=q[3],v=q[4];var w=q[5],x=q[6],y=q[7],z=q[8],A=q[9];var B=q[10],C=q[11],D=q[12],E=q[13],F=q[14];var G=q[15],H=q[16],I=q[17],J=q[18],K=q[19];for(var L=0;L<l;L+=4){m=k[L];n=k[L+1];o=k[L+2];p=k[L+3];k[L]=m*r+n*s+o*t+p*u+v;k[L+1]=m*w+n*x+o*y+p*z+A;k[L+2]=m*B+n*C+o*D+p*E+F;k[L+3]=m*G+n*H+o*I+p*J+K}i.data=k;f.putImageData(i,g,h);return true};c.toString=function(){return"[ColorMatrixFilter]"};c.clone=function(){return new b(this.matrix)};a.ColorMatrixFilter=b})(window)